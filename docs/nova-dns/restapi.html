<!DOCTYPE html PUBLIC
        "-//W3C//DTD XHTML 1.1//EN"
        "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8"/>
    <title>Nova DNS Project Documentation &mdash; GridDynamics OpenStack Portal</title>
    <link rel="stylesheet" href="/media/css/bootstrap.css">
    <link rel="stylesheet" href="/media/css/site.css">
    <style type="text/css">
        body {
            padding-top: 60px;
        }

        #license {
            border-width: 0;
        }
    </style>
</head>
<body>

<div class="topbar">
    <div class="fill">
        <div class="container">
            <a class="brand" href="/">Grid Dynamics OpenStack Portal</a>
            <ul class="nav">
                <li><a href="https://github.com/griddynamics/openstack/wiki">Wiki</a></li>
                <li><a href="https://github.com/griddynamics/openstack/issues">Issues</a></li>
                <li><a href="http://openstackgd.wordpress.com/">Blog</a></li>
            </ul>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="sidebar sphinx-toc">
        <h3>Table of Content</h3>
            <ul>
<li><a class="reference internal" href="#">REST API</a><ul>
<li><a class="reference internal" href="#reply-format">Reply format</a></li>
<li><a class="reference internal" href="#version-info-and-links">Version info and links</a></li>
<li><a class="reference internal" href="#work-with-zones">Work with zones</a><ul>
<li><a class="reference internal" href="#list-of-all-zones">List of all zones</a></li>
<li><a class="reference internal" href="#get-zone-s-soa">Get zone&#8217;s SOA</a></li>
<li><a class="reference internal" href="#create-zone">Create zone</a></li>
<li><a class="reference internal" href="#delete-zone">Delete zone</a></li>
</ul>
</li>
<li><a class="reference internal" href="#work-with-records">Work with records</a><ul>
<li><a class="reference internal" href="#aceptable-record-type">Aceptable record type</a></li>
<li><a class="reference internal" href="#list-records">List records</a></li>
<li><a class="reference internal" href="#add-record">Add record</a></li>
<li><a class="reference internal" href="#edit-record">Edit record</a></li>
<li><a class="reference internal" href="#delete-record">Delete record</a></li>
</ul>
</li>
</ul>
</li>
</ul>
        <h3>Navigation</h3>
        <ul>
            <li>
                <a href="/docs/nova-dns">To the beginning</a>
            </li>
                            <li><a href="quickstart.html"
                       title="Quickstart">&lt;- Quickstart</a>
                </li>
                                        <li><a href="config.html"
                       title="Configuration">-&gt; Configuration</a>
                </li>
                    </ul>
    </div>

    <div class="content"><div class="section" id="rest-api">
<h1><a class="toc-backref" href="#id1">REST API</a><a class="headerlink" href="#rest-api" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#rest-api" id="id1">REST API</a><ul>
<li><a class="reference internal" href="#reply-format" id="id2">Reply format</a></li>
<li><a class="reference internal" href="#version-info-and-links" id="id3">Version info and links</a></li>
<li><a class="reference internal" href="#work-with-zones" id="id4">Work with zones</a><ul>
<li><a class="reference internal" href="#list-of-all-zones" id="id5">List of all zones</a></li>
<li><a class="reference internal" href="#get-zone-s-soa" id="id6">Get zone&#8217;s SOA</a></li>
<li><a class="reference internal" href="#create-zone" id="id7">Create zone</a></li>
<li><a class="reference internal" href="#delete-zone" id="id8">Delete zone</a></li>
</ul>
</li>
<li><a class="reference internal" href="#work-with-records" id="id9">Work with records</a><ul>
<li><a class="reference internal" href="#aceptable-record-type" id="id10">Aceptable record type</a></li>
<li><a class="reference internal" href="#list-records" id="id11">List records</a></li>
<li><a class="reference internal" href="#add-record" id="id12">Add record</a></li>
<li><a class="reference internal" href="#edit-record" id="id13">Edit record</a></li>
<li><a class="reference internal" href="#delete-record" id="id14">Delete record</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="reply-format">
<h2><a class="toc-backref" href="#id2">Reply format</a><a class="headerlink" href="#reply-format" title="Permalink to this headline">¶</a></h2>
<p>All commands return JSON, all except <em>Version</em> return json in <em>JSON RPC</em> format:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;error&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;result&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>result</strong> - The Object that was returned by the invoked method. This must be
null in case there was an error invoking the method.</li>
<li><strong>error</strong> - An Error object if there was an error invoking the method. It must
be null if there was no error.</li>
</ul>
</div>
<div class="section" id="version-info-and-links">
<h2><a class="toc-backref" href="#id3">Version info and links</a><a class="headerlink" href="#version-info-and-links" title="Permalink to this headline">¶</a></h2>
<p><strong>GET /</strong></p>
<p>return version info and links</p>
<div class="highlight-javascript"><pre># curl "localhost:15353/" | python -m json.tool
{
    "application": "nova-dns",
    "links": [
        {
            "href": "http://127.0.0.1:15353/zone",
            "rel": "self"
        },
        {
            "href": "http://127.0.0.1:15353/record",
            "rel": "self"
        }
    ],
    "version": "0.0.5"
}</pre>
</div>
</div>
<div class="section" id="work-with-zones">
<h2><a class="toc-backref" href="#id4">Work with zones</a><a class="headerlink" href="#work-with-zones" title="Permalink to this headline">¶</a></h2>
<div class="section" id="list-of-all-zones">
<h3><a class="toc-backref" href="#id5">List of all zones</a><a class="headerlink" href="#list-of-all-zones" title="Permalink to this headline">¶</a></h3>
<p><strong>GET /zone</strong></p>
<p>return list of registered zones</p>
<div class="highlight-javascript"><pre># curl "localhost:15353/zone/" | python -m json.tool
{
    "error": null,
    "result": [
        "example.test.com",
        "test.com"
    ]
}</pre>
</div>
</div>
<div class="section" id="get-zone-s-soa">
<h3><a class="toc-backref" href="#id6">Get zone&#8217;s SOA</a><a class="headerlink" href="#get-zone-s-soa" title="Permalink to this headline">¶</a></h3>
<p><strong>GET /zone/name</strong></p>
<p>return SOA record if zone exists or &#8220;<em>Zone does not exist</em>&#8221; error otherwise</p>
<div class="highlight-javascript"><pre># curl "localhost:15353/zone/test.com" | python -m json.tool
{
    "error": null,
    "result": {
        "content": "",
        "expire": 604800,
        "hostmaster": "hostmaster",
        "name": "",
        "primary": "ns1",
        "priority": 0,
        "refresh": 10800,
        "retry": 3600,
        "serial": "1329317890",
        "ttl": 7200,
        "type": "SOA"
    }
}</pre>
</div>
</div>
<div class="section" id="create-zone">
<h3><a class="toc-backref" href="#id7">Create zone</a><a class="headerlink" href="#create-zone" title="Permalink to this headline">¶</a></h3>
<p><strong>PUT /zone/name[?soa_params]</strong></p>
<p>Create new zone. if any SOA  param omitted, backend has to use reasonable default.</p>
<p>SOA params:</p>
<ul class="simple">
<li>primary</li>
<li>hostmaster</li>
<li>refresh</li>
<li>retry</li>
<li>expire</li>
<li>ttl</li>
</ul>
<p>Return &#8216;ok&#8217; on success or &#8220;*&#8221;Zone already exists*&#8221; error</p>
<div class="highlight-javascript"><pre># curl "localhost:15353/zone/some.test.com" -X PUT | python -m json.tool
{
    "error": null,
    "result": "ok"
}</pre>
</div>
</div>
<div class="section" id="delete-zone">
<h3><a class="toc-backref" href="#id8">Delete zone</a><a class="headerlink" href="#delete-zone" title="Permalink to this headline">¶</a></h3>
<p><strong>DELETE /zone/name[?force=1]</strong></p>
<p>Drop zone and all records in zone.</p>
<p>If &#8220;force&#8221; param provided, will delete all sub-zones</p>
<p>If not - will refuse to delete if there are any sub-zone for this zone
with &#8220;<em>Subzones exists: (list of zones)</em>&#8221; error</p>
<p>Return &#8220;ok&#8221; on success</p>
<div class="highlight-javascript"><pre># curl "localhost:15353/zone/test.com" -X DELETE | python -m json.tool
{
    "error": "Subzones exists: test.com example.test.com some.test.com",
    "result": null
}

# curl "localhost:15353/zone/some.test.com" -X DELETE | python -m json.tool
{
    "error": null,
    "result": "ok"
}

# curl "localhost:15353/zone/test.com?force=1" -X DELETE | python -m json.tool
{
    "error": null,
    "result": "ok"
}</pre>
</div>
</div>
</div>
<div class="section" id="work-with-records">
<h2><a class="toc-backref" href="#id9">Work with records</a><a class="headerlink" href="#work-with-records" title="Permalink to this headline">¶</a></h2>
<div class="section" id="aceptable-record-type">
<h3><a class="toc-backref" href="#id10">Aceptable record type</a><a class="headerlink" href="#aceptable-record-type" title="Permalink to this headline">¶</a></h3>
<p>Record type can be any from</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="s1">&#39;A&#39;</span>, <span class="s1">&#39;AAAA&#39;</span>, <span class="s1">&#39;MX&#39;</span>, <span class="s1">&#39;SOA&#39;</span>, <span class="s1">&#39;CNAME&#39;</span>, <span class="s1">&#39;PTR&#39;</span>, <span class="s1">&#39;SPF&#39;</span>, <span class="s1">&#39;SRV&#39;</span>, <span class="s1">&#39;TXT&#39;</span>, <span class="s1">&#39;NS&#39;</span>,
<span class="s1">&#39;AFSDB&#39;</span>, <span class="s1">&#39;CERT&#39;</span>, <span class="s1">&#39;DNSKEY&#39;</span>, <span class="s1">&#39;DS&#39;</span>, <span class="s1">&#39;HINFO&#39;</span>, <span class="s1">&#39;KEY&#39;</span>, <span class="s1">&#39;LOC&#39;</span>, <span class="s1">&#39;NAPTR&#39;</span>, <span class="s1">&#39;RP&#39;</span>,
<span class="s1">&#39;RRSIG&#39;</span>, <span class="s1">&#39;SSHFP&#39;</span>
</pre></div>
</div>
<p>in case of invalid type of record error &#8220;<em>Incorrect type: your_value</em>&#8221;
will be generated</p>
</div>
<div class="section" id="list-records">
<h3><a class="toc-backref" href="#id11">List records</a><a class="headerlink" href="#list-records" title="Permalink to this headline">¶</a></h3>
<p><strong>GET /record/zonename[?name=&amp;type=]</strong></p>
<p>On success return JSON in format TODO:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;content&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;ttl&quot;</span><span class="o">:</span> <span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span>
<span class="p">},</span>
</pre></div>
</div>
<p>If <em>name</em> or <em>type</em> params provided, results will be filtered to specified
names and/or types</p>
<div class="highlight-javascript"><pre># curl "localhost:15353/record/test.com" | python -m json.tool
{
    "error": null,
    "result": [
        {
            "content": "2.2.2.2",
            "name": "dynamic.test.com",
            "priority": 0,
            "ttl": 120,
            "type": "A"
        },
        {
            "content": "",
            "expire": 604800,
            "hostmaster": "hostmaster",
            "name": "",
            "primary": "ns1",
            "priority": 0,
            "refresh": 10800,
            "retry": 3600,
            "serial": "1329319594",
            "ttl": 7200,
            "type": "SOA"
        },
        {
            "content": "1.1.1.1",
            "name": "test.com",
            "priority": 0,
            "ttl": 7200,
            "type": "A"
        },
        {
            "content": "1.1.1.1",
            "name": "mx1.test.com",
            "priority": 10,
            "ttl": 7200,
            "type": "MX"
        }
    ]
}</pre>
</div>
</div>
<div class="section" id="add-record">
<h3><a class="toc-backref" href="#id12">Add record</a><a class="headerlink" href="#add-record" title="Permalink to this headline">¶</a></h3>
<p><strong>PUT /record/zonename/name/type/content[?ttl&amp;priority]</strong></p>
<p>Add record</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><em>SOA</em> record can&#8217;t be added thru this intreface</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>SOA</em> serial will be updated automatically</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If name empty, provide <strong>&#64;</strong>.</p>
</div>
<div class="highlight-javascript"><pre># curl "localhost:15353/record/test.com/@/a/1.1.1.1" -X PUT | python -m json.tool
{
    "error": null,
    "result": "ok"
}
# curl "localhost:15353/record/test.com/mx1/mx/1.1.1.1?priority=10" -X PUT | python -m json.tool
{
    "error": null,
    "result": "ok"
}
# curl "localhost:15353/record/test.com/dynamic/a/2.2.2.2?ttl=120" -X PUT | python -m json.tool
{
    "error": null,
    "result": "ok"
}</pre>
</div>
</div>
<div class="section" id="edit-record">
<h3><a class="toc-backref" href="#id13">Edit record</a><a class="headerlink" href="#edit-record" title="Permalink to this headline">¶</a></h3>
<p><strong>POST /record/zonename/name/type?[params]</strong></p>
<p>Editable params:</p>
<ul class="simple">
<li><strong>content</strong></li>
<li><strong>ttl</strong></li>
<li><strong>priority</strong></li>
</ul>
<p>Update record. Return &#8216;ok&#8217; on success</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>SOA</em> serial will be updated automatically</p>
</div>
<div class="highlight-javascript"><pre># curl "localhost:15353/record/test.com/@/A?content=3.3.3.3" -X POST | python -m json.tool
{
    "error": null,
    "result": "ok"
}</pre>
</div>
</div>
<div class="section" id="delete-record">
<h3><a class="toc-backref" href="#id14">Delete record</a><a class="headerlink" href="#delete-record" title="Permalink to this headline">¶</a></h3>
<p><strong>DELETE /record/zonename/name/type</strong></p>
<p>Delete record. Return &#8216;ok&#8217; on success</p>
<div class="highlight-javascript"><pre># curl "localhost:15353/record/test.com/dynamic/a" -X DELETE | python -m json.tool
{
    "error": null,
    "result": "ok"
}</pre>
</div>
</div>
</div>
</div>
</div>

        <footer>
        <p>
            <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">
                <img alt="Creative Commons License"
                     style="border-width:0"
                     src="http://i.creativecommons.org/l/by-nc/3.0/80x15.png"/>
            </a>
            Grid Dynamics, 2011
        </p>
    </footer>


</div>


</body>
</html>
